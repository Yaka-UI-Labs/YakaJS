<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signals & Reactivity - YakaJS Demos</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- YakaJS -->
    <script src="https://cdn.jsdelivr.net/gh/Yaka-UI-Labs/YakaJS@latest/dist/min.yaka.js"></script>
    
    <style>
        /* Raw Black with Noise & Gradient Design */
        
        /* Outfit Font */
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Outfit', system-ui, sans-serif;
        }
        
        /* Raw Black Background with Noise and Gradient */
        body {
            background: 
                /* Subtle gradient overlay */
                linear-gradient(135deg, 
                    rgba(99, 102, 241, 0.05) 0%,
                    rgba(139, 92, 246, 0.03) 25%,
                    rgba(168, 85, 247, 0.05) 50%,
                    rgba(217, 70, 239, 0.03) 75%,
                    rgba(99, 102, 241, 0.05) 100%
                ),
                /* Noise texture using SVG pattern */
                url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E"),
                /* Base black */
                #000000;
            background-size: 400% 400%, 200px 200px, auto;
            background-attachment: fixed, fixed, fixed;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
            font-family: 'Outfit', sans-serif;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%, 0 0, 0 0; }
            50% { background-position: 100% 50%, 100px 100px, 0 0; }
            100% { background-position: 0% 50%, 0 0, 0 0; }
        }
        
        /* Glassmorphism on Black */
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 8px 32px 0 rgba(0, 0, 0, 0.6),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.05);
        }
        
        .glass-dark {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            box-shadow: 
                0 4px 24px 0 rgba(0, 0, 0, 0.8),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.03);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.04);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 8px 32px 0 rgba(0, 0, 0, 0.7),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.06);
        }
        
        /* Smooth transitions */
        .transition-glass {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-4px) scale(1.01);
            border-color: rgba(139, 92, 246, 0.3);
            box-shadow: 
                0 16px 48px 0 rgba(139, 92, 246, 0.2),
                0 0 80px 0 rgba(139, 92, 246, 0.1),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.1);
        }
        
        /* Code blocks on black */
        pre {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1rem;
            overflow-x: auto;
            border: 1px solid rgba(99, 102, 241, 0.2);
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.5);
        }
        
        code {
            color: #a78bfa;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
        }
        
        .demo-result {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(8px);
            border-radius: 8px;
            padding: 1rem;
            min-height: 100px;
        }

        .signal-value {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid rgba(139, 92, 246, 0.5);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            text-align: center;
        }

        .reactive-update {
            animation: pulse 0.3s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body class="p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h1 class="text-5xl font-bold text-white mb-4">‚ö° Signals & Reactivity</h1>
            <p class="text-white text-lg mb-4">Reactive programming with signals, effects, and computed values</p>
            <a href="index.html" class="text-white hover:text-yellow-300 transition-colors">‚Üê Back to Demos</a>
        </div>

        <!-- Basic Signal Example -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üìä Basic Signal</h2>
            <p class="text-white mb-4">Create reactive values that notify observers when changed</p>
            
            <pre><code>const count = _.signal(0);
count(); // Get value: 0
count.set(5); // Set value
count.update(n => n + 1); // Update with function</code></pre>

            <div class="demo-result mt-4">
                <div class="flex items-center gap-4 mb-4">
                    <button onclick="decrementBasic()" class="glass px-6 py-3 rounded-lg text-white font-semibold hover:bg-white/20 transition">‚àí</button>
                    <div id="basicSignalValue" class="signal-value flex-1">0</div>
                    <button onclick="incrementBasic()" class="glass px-6 py-3 rounded-lg text-white font-semibold hover:bg-white/20 transition">+</button>
                </div>
                <button onclick="resetBasic()" class="glass px-4 py-2 rounded-lg text-white hover:bg-white/20 transition">Reset</button>
            </div>
        </div>

        <!-- Effect Example -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üîÑ Effects</h2>
            <p class="text-white mb-4">Automatically run code when signals change</p>
            
            <pre><code>const name = _.signal('World');
_.effect(() => {
    console.log(`Hello, ${name()}!`);
}); // Runs immediately and on every change</code></pre>

            <div class="demo-result mt-4">
                <input type="text" id="effectInput" placeholder="Enter your name..." 
                    class="glass w-full px-4 py-3 rounded-lg text-white mb-4 placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/50">
                <div class="text-white text-xl mb-4">Effect output:</div>
                <div id="effectOutput" class="signal-value">Hello, World!</div>
                <div class="text-white/70 text-sm mt-2">Effect runs: <span id="effectCount">1</span></div>
            </div>
        </div>

        <!-- Computed Values -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üßÆ Computed Values</h2>
            <p class="text-white mb-4">Derived reactive values that update automatically</p>
            
            <pre><code>const firstName = _.signal('John');
const lastName = _.signal('Doe');
const fullName = _.computed(() => 
    `${firstName()} ${lastName()}`
);</code></pre>

            <div class="demo-result mt-4">
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="text-white block mb-2">First Name:</label>
                        <input type="text" id="firstName" value="John" 
                            class="glass w-full px-4 py-2 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/50">
                    </div>
                    <div>
                        <label class="text-white block mb-2">Last Name:</label>
                        <input type="text" id="lastName" value="Doe" 
                            class="glass w-full px-4 py-2 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/50">
                    </div>
                </div>
                <div class="text-white mb-2">Full Name (computed):</div>
                <div id="computedName" class="signal-value">John Doe</div>
            </div>
        </div>

        <!-- Shopping Cart Example -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üõí Shopping Cart</h2>
            <p class="text-white mb-4">Quantity √ó Price = Total (automatically computed)</p>

            <div class="demo-result mt-4">
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="text-white block mb-2">Quantity:</label>
                        <div class="flex items-center gap-2">
                            <button onclick="updateQuantity(-1)" class="glass px-4 py-2 rounded-lg text-white hover:bg-white/20 transition">‚àí</button>
                            <input type="number" id="quantity" value="1" min="0"
                                class="glass flex-1 px-4 py-2 rounded-lg text-white text-center focus:outline-none focus:ring-2 focus:ring-white/50">
                            <button onclick="updateQuantity(1)" class="glass px-4 py-2 rounded-lg text-white hover:bg-white/20 transition">+</button>
                        </div>
                    </div>
                    <div>
                        <label class="text-white block mb-2">Price ($):</label>
                        <input type="number" id="price" value="29.99" step="0.01" min="0"
                            class="glass w-full px-4 py-2 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/50">
                    </div>
                </div>
                <div class="text-white text-2xl mb-2">Total:</div>
                <div id="cartTotal" class="signal-value text-3xl">$29.99</div>
            </div>
        </div>

        <!-- Temperature Converter -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üå°Ô∏è Temperature Converter</h2>
            <p class="text-white mb-4">Bidirectional reactive conversion between Celsius and Fahrenheit</p>

            <div class="demo-result mt-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-white block mb-2">Celsius:</label>
                        <input type="number" id="celsius" value="0" step="0.1"
                            class="glass w-full px-4 py-2 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/50">
                        <div id="celsiusDisplay" class="signal-value mt-2">0¬∞C</div>
                    </div>
                    <div>
                        <label class="text-white block mb-2">Fahrenheit:</label>
                        <input type="number" id="fahrenheit" value="32" step="0.1"
                            class="glass w-full px-4 py-2 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/50">
                        <div id="fahrenheitDisplay" class="signal-value mt-2">32¬∞F</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reactive Form -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üìù Reactive Form</h2>
            <p class="text-white mb-4">Form validation with reactive signals</p>

            <div class="demo-result mt-4">
                <div class="mb-4">
                    <label class="text-white block mb-2">Email:</label>
                    <input type="email" id="email" placeholder="user@example.com"
                        class="glass w-full px-4 py-2 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/50">
                    <div id="emailValidation" class="text-sm mt-2"></div>
                </div>
                <div class="mb-4">
                    <label class="text-white block mb-2">Password:</label>
                    <input type="password" id="password" placeholder="Min 8 characters"
                        class="glass w-full px-4 py-2 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/50">
                    <div id="passwordValidation" class="text-sm mt-2"></div>
                </div>
                <div class="mb-4">
                    <label class="text-white block mb-2">Confirm Password:</label>
                    <input type="password" id="confirmPassword"
                        class="glass w-full px-4 py-2 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/50">
                    <div id="confirmValidation" class="text-sm mt-2"></div>
                </div>
                <button id="submitBtn" disabled
                    class="glass px-6 py-3 rounded-lg text-white font-semibold disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white/20 transition">
                    Submit
                </button>
                <div id="formStatus" class="signal-value mt-4 hidden">Form is valid! ‚úì</div>
            </div>
        </div>

        <!-- Reactivity Graph -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üìà Reactivity Graph</h2>
            <p class="text-white mb-4">Visualize dependencies between signals and effects</p>

            <div class="demo-result mt-4">
                <div class="mb-4">
                    <label class="text-white block mb-2">Base Value:</label>
                    <input type="range" id="baseValue" min="0" max="100" value="50"
                        class="w-full">
                    <div id="baseValueDisplay" class="signal-value mt-2">50</div>
                </div>
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div>
                        <div class="text-white text-sm mb-2">Doubled:</div>
                        <div id="doubled" class="signal-value">100</div>
                    </div>
                    <div>
                        <div class="text-white text-sm mb-2">Squared:</div>
                        <div id="squared" class="signal-value">2500</div>
                    </div>
                    <div>
                        <div class="text-white text-sm mb-2">Sum:</div>
                        <div id="sum" class="signal-value">2650</div>
                    </div>
                </div>
                <div class="text-white/70 text-sm mt-4">
                    Dependencies: base ‚Üí doubled, base ‚Üí squared, (doubled + squared) ‚Üí sum
                </div>
            </div>
        </div>

        <!-- Interactive Counter with Multiple Effects -->
        <div class="glass-card rounded-2xl p-8 transition-glass">
            <h2 class="text-3xl font-bold text-white mb-4">üéØ Multi-Effect Counter</h2>
            <p class="text-white mb-4">One signal triggers multiple effects</p>

            <div class="demo-result mt-4">
                <div class="flex items-center gap-4 mb-4">
                    <button onclick="decrementMulti()" class="glass px-6 py-3 rounded-lg text-white font-semibold hover:bg-white/20 transition">‚àí</button>
                    <div id="multiCounterValue" class="signal-value flex-1">0</div>
                    <button onclick="incrementMulti()" class="glass px-6 py-3 rounded-lg text-white font-semibold hover:bg-white/20 transition">+</button>
                </div>
                <div class="grid grid-cols-3 gap-4">
                    <div class="glass-dark p-4 rounded-lg">
                        <div class="text-white text-sm mb-2">Is Even:</div>
                        <div id="isEven" class="text-white font-bold text-xl">Yes</div>
                    </div>
                    <div class="glass-dark p-4 rounded-lg">
                        <div class="text-white text-sm mb-2">Is Positive:</div>
                        <div id="isPositive" class="text-white font-bold text-xl">No</div>
                    </div>
                    <div class="glass-dark p-4 rounded-lg">
                        <div class="text-white text-sm mb-2">Squared:</div>
                        <div id="counterSquared" class="text-white font-bold text-xl">0</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if YakaJS is available
        if (typeof _ === 'undefined' || !_.signal) {
            document.body.innerHTML = '<div class="glass-card rounded-2xl p-8 m-8"><h1 class="text-white text-2xl">YakaJS not loaded. Please build the project first: npm run build</h1></div>';
        } else {
            // Basic Signal
            const basicCount = _.signal(0);
            _.effect(() => {
                const el = document.getElementById('basicSignalValue');
                if (el) {
                    el.textContent = basicCount();
                    el.classList.add('reactive-update');
                    setTimeout(() => el.classList.remove('reactive-update'), 300);
                }
            });

            window.incrementBasic = () => basicCount.update(n => n + 1);
            window.decrementBasic = () => basicCount.update(n => n - 1);
            window.resetBasic = () => basicCount.set(0);

            // Effect Example
            const effectName = _.signal('World');
            let effectRunCount = 0;
            _.effect(() => {
                effectRunCount++;
                const output = document.getElementById('effectOutput');
                const count = document.getElementById('effectCount');
                if (output) output.textContent = `Hello, ${effectName()}!`;
                if (count) count.textContent = effectRunCount;
            });

            const effectInput = document.getElementById('effectInput');
            if (effectInput) {
                effectInput.addEventListener('input', (e) => {
                    effectName.set(e.target.value || 'World');
                });
            }

            // Computed Values
            const firstName = _.signal('John');
            const lastName = _.signal('Doe');
            const fullName = _.computed(() => `${firstName()} ${lastName()}`);

            _.effect(() => {
                const el = document.getElementById('computedName');
                if (el) el.textContent = fullName();
            });

            ['firstName', 'lastName'].forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', (e) => {
                        if (id === 'firstName') firstName.set(e.target.value);
                        else lastName.set(e.target.value);
                    });
                }
            });

            // Shopping Cart
            const quantity = _.signal(1);
            const price = _.signal(29.99);
            const total = _.computed(() => quantity() * price());

            _.effect(() => {
                const el = document.getElementById('cartTotal');
                if (el) el.textContent = `$${total().toFixed(2)}`;
            });

            window.updateQuantity = (delta) => {
                const newQty = Math.max(0, quantity() + delta);
                quantity.set(newQty);
                document.getElementById('quantity').value = newQty;
            };

            ['quantity', 'price'].forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', (e) => {
                        const val = parseFloat(e.target.value) || 0;
                        if (id === 'quantity') quantity.set(val);
                        else price.set(val);
                    });
                }
            });

            // Temperature Converter
            const celsius = _.signal(0);
            const fahrenheit = _.computed(() => celsius() * 9/5 + 32);

            let updatingTemp = false;

            _.effect(() => {
                if (!updatingTemp) {
                    const f = fahrenheit();
                    const fInput = document.getElementById('fahrenheit');
                    const fDisplay = document.getElementById('fahrenheitDisplay');
                    if (fInput) fInput.value = f.toFixed(1);
                    if (fDisplay) fDisplay.textContent = `${f.toFixed(1)}¬∞F`;
                }
            });

            _.effect(() => {
                const c = celsius();
                const cDisplay = document.getElementById('celsiusDisplay');
                if (cDisplay) cDisplay.textContent = `${c.toFixed(1)}¬∞C`;
            });

            const celsiusInput = document.getElementById('celsius');
            if (celsiusInput) {
                celsiusInput.addEventListener('input', (e) => {
                    updatingTemp = true;
                    celsius.set(parseFloat(e.target.value) || 0);
                    updatingTemp = false;
                });
            }

            const fahrenheitInput = document.getElementById('fahrenheit');
            if (fahrenheitInput) {
                fahrenheitInput.addEventListener('input', (e) => {
                    updatingTemp = true;
                    const f = parseFloat(e.target.value) || 0;
                    celsius.set((f - 32) * 5/9);
                    updatingTemp = false;
                });
            }

            // Reactive Form
            const email = _.signal('');
            const password = _.signal('');
            const confirmPassword = _.signal('');

            const emailValid = _.computed(() => {
                const e = email();
                return e.length > 0 && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);
            });

            const passwordValid = _.computed(() => password().length >= 8);
            const passwordsMatch = _.computed(() => 
                password().length > 0 && password() === confirmPassword()
            );

            const formValid = _.computed(() => 
                emailValid() && passwordValid() && passwordsMatch()
            );

            _.effect(() => {
                const el = document.getElementById('emailValidation');
                if (el) {
                    if (email().length === 0) el.textContent = '';
                    else if (emailValid()) {
                        el.textContent = '‚úì Valid email';
                        el.className = 'text-sm mt-2 text-green-300';
                    } else {
                        el.textContent = '‚úó Invalid email';
                        el.className = 'text-sm mt-2 text-red-300';
                    }
                }
            });

            _.effect(() => {
                const el = document.getElementById('passwordValidation');
                if (el) {
                    if (password().length === 0) el.textContent = '';
                    else if (passwordValid()) {
                        el.textContent = '‚úì Strong password';
                        el.className = 'text-sm mt-2 text-green-300';
                    } else {
                        el.textContent = '‚úó Password too short';
                        el.className = 'text-sm mt-2 text-red-300';
                    }
                }
            });

            _.effect(() => {
                const el = document.getElementById('confirmValidation');
                if (el) {
                    if (confirmPassword().length === 0) el.textContent = '';
                    else if (passwordsMatch()) {
                        el.textContent = '‚úì Passwords match';
                        el.className = 'text-sm mt-2 text-green-300';
                    } else {
                        el.textContent = '‚úó Passwords do not match';
                        el.className = 'text-sm mt-2 text-red-300';
                    }
                }
            });

            _.effect(() => {
                const btn = document.getElementById('submitBtn');
                const status = document.getElementById('formStatus');
                if (btn) btn.disabled = !formValid();
                if (status) {
                    if (formValid()) {
                        status.classList.remove('hidden');
                    } else {
                        status.classList.add('hidden');
                    }
                }
            });

            ['email', 'password', 'confirmPassword'].forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', (e) => {
                        if (id === 'email') email.set(e.target.value);
                        else if (id === 'password') password.set(e.target.value);
                        else confirmPassword.set(e.target.value);
                    });
                }
            });

            // Reactivity Graph
            const baseValue = _.signal(50);
            const doubled = _.computed(() => baseValue() * 2);
            const squared = _.computed(() => baseValue() ** 2);
            const sumComputed = _.computed(() => doubled() + squared());

            _.effect(() => {
                const el = document.getElementById('baseValueDisplay');
                if (el) el.textContent = baseValue();
            });

            _.effect(() => {
                const el = document.getElementById('doubled');
                if (el) el.textContent = doubled();
            });

            _.effect(() => {
                const el = document.getElementById('squared');
                if (el) el.textContent = squared();
            });

            _.effect(() => {
                const el = document.getElementById('sum');
                if (el) el.textContent = sumComputed();
            });

            const baseInput = document.getElementById('baseValue');
            if (baseInput) {
                baseInput.addEventListener('input', (e) => {
                    baseValue.set(parseInt(e.target.value) || 0);
                });
            }

            // Multi-Effect Counter
            const multiCounter = _.signal(0);

            _.effect(() => {
                const el = document.getElementById('multiCounterValue');
                if (el) el.textContent = multiCounter();
            });

            _.effect(() => {
                const el = document.getElementById('isEven');
                if (el) el.textContent = multiCounter() % 2 === 0 ? 'Yes' : 'No';
            });

            _.effect(() => {
                const el = document.getElementById('isPositive');
                if (el) el.textContent = multiCounter() > 0 ? 'Yes' : 'No';
            });

            _.effect(() => {
                const el = document.getElementById('counterSquared');
                if (el) el.textContent = multiCounter() ** 2;
            });

            window.incrementMulti = () => multiCounter.update(n => n + 1);
            window.decrementMulti = () => multiCounter.update(n => n - 1);
        }
    </script>
</body>
</html>
