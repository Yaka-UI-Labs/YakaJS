<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YakaJS - Utility Functions Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        
        .demo-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .demo-card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }
        
        .demo-content {
            margin-top: 15px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin: 5px;
            transition: all 0.2s;
        }
        
        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }
        
        .result {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }
        
        .info {
            background: #e3f2fd;
            padding: 12px;
            border-left: 4px solid #2196F3;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #1565C0;
        }
        
        input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            margin: 5px 0;
            font-size: 14px;
        }
        
        label {
            display: block;
            margin-top: 10px;
            font-weight: 600;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ†Ô∏è YakaJS - Utility Functions</h1>
            <p class="subtitle">50+ Lodash-like Utilities | Date Helpers | Type Checking | Promise Utils</p>
        </div>
        
        <div class="demo-grid">
            <!-- Deep Object Utilities -->
            <div class="demo-card">
                <h2>üîÑ Deep Object Utils</h2>
                <div class="info">Deep clone, merge, get, set, pick, omit</div>
                <div class="demo-content">
                    <button onclick="demoDeepClone()">Deep Clone</button>
                    <button onclick="demoMerge()">Merge Objects</button>
                    <button onclick="demoGetSet()">Get/Set Nested</button>
                    <button onclick="demoPickOmit()">Pick/Omit</button>
                    <div id="object-result" class="result"></div>
                </div>
            </div>
            
            <!-- Array Methods -->
            <div class="demo-card">
                <h2>üìö Array Methods</h2>
                <div class="info">chunk, flatten, uniq, groupBy, sortBy, partition</div>
                <div class="demo-content">
                    <button onclick="demoChunk()">Chunk Array</button>
                    <button onclick="demoFlatten()">Flatten</button>
                    <button onclick="demoUniq()">Remove Duplicates</button>
                    <button onclick="demoGroupBy()">Group By</button>
                    <button onclick="demoSetOps()">Set Operations</button>
                    <div id="array-result" class="result"></div>
                </div>
            </div>
            
            <!-- String Utilities -->
            <div class="demo-card">
                <h2>‚úèÔ∏è String Utils</h2>
                <div class="info">Case conversions, slugify, truncate, escape</div>
                <div class="demo-content">
                    <input type="text" id="string-input" placeholder="Enter text..." value="Hello World 2024">
                    <button onclick="demoCaseConversion()">Case Conversions</button>
                    <button onclick="demoSlugify()">Slugify</button>
                    <button onclick="demoTruncate()">Truncate</button>
                    <button onclick="demoEscape()">HTML Escape</button>
                    <div id="string-result" class="result"></div>
                </div>
            </div>
            
            <!-- Date Utilities -->
            <div class="demo-card">
                <h2>üìÖ Date & Time Utils</h2>
                <div class="info">Format, relative time, date arithmetic</div>
                <div class="demo-content">
                    <button onclick="demoFormatDate()">Format Date</button>
                    <button onclick="demoFromNow()">Relative Time</button>
                    <button onclick="demoDiffDates()">Date Difference</button>
                    <button onclick="demoAddDates()">Date Arithmetic</button>
                    <div id="date-result" class="result"></div>
                </div>
            </div>
            
            <!-- Type Checking -->
            <div class="demo-card">
                <h2>üîç Type Checking</h2>
                <div class="info">13 type checking utilities</div>
                <div class="demo-content">
                    <button onclick="demoTypeChecking()">Check All Types</button>
                    <button onclick="demoIsEmpty()">isEmpty Tests</button>
                    <div id="type-result" class="result"></div>
                </div>
            </div>
            
            <!-- Promise/Async -->
            <div class="demo-card">
                <h2>‚è±Ô∏è Promise/Async Utils</h2>
                <div class="info">sleep, retry, timeout, allSettled</div>
                <div class="demo-content">
                    <button onclick="demoSleep()">Sleep/Delay</button>
                    <button onclick="demoRetry()">Retry with Backoff</button>
                    <button onclick="demoTimeout()">Promise Timeout</button>
                    <button onclick="demoAllSettled()">All Settled</button>
                    <div id="promise-result" class="result"></div>
                </div>
            </div>
            
            <!-- Math Utilities -->
            <div class="demo-card">
                <h2>üî¢ Math Utils</h2>
                <div class="info">clamp, random, sum, mean, median</div>
                <div class="demo-content">
                    <button onclick="demoMath()">Array Math</button>
                    <button onclick="demoClamp()">Clamp Values</button>
                    <button onclick="demoRandom()">Random Numbers</button>
                    <div id="math-result" class="result"></div>
                </div>
            </div>
            
            <!-- Collection Methods -->
            <div class="demo-card">
                <h2>üé≤ Collection Methods</h2>
                <div class="info">range, shuffle, sample, sortBy</div>
                <div class="demo-content">
                    <button onclick="demoRange()">Generate Range</button>
                    <button onclick="demoShuffle()">Shuffle Array</button>
                    <button onclick="demoSample()">Random Sample</button>
                    <button onclick="demoPartition()">Partition</button>
                    <div id="collection-result" class="result"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="yaka.js"></script>
    <script>
        _.debug = true;
        console.log('üõ†Ô∏è YakaJS Utility Functions Demo');
        
        // Deep Object Utilities
        function demoDeepClone() {
            const original = { a: { b: { c: [1, 2, 3] } }, date: new Date() };
            const cloned = _.deepClone(original);
            cloned.a.b.c.push(4);
            
            _('#object-result').html(
                `Original: ${JSON.stringify(original.a.b.c)}\n` +
                `Cloned (modified): ${JSON.stringify(cloned.a.b.c)}\n` +
                `‚úÖ Deep clone preserves independence!`
            );
        }
        
        function demoMerge() {
            const obj1 = { a: 1, b: { c: 2 } };
            const obj2 = { b: { d: 3 }, e: 4 };
            const merged = _.merge(obj1, obj2);
            
            _('#object-result').html(JSON.stringify(merged, null, 2));
        }
        
        function demoGetSet() {
            const obj = { user: { profile: { name: 'John' } } };
            
            const name = _.get(obj, 'user.profile.name', 'Unknown');
            _.set(obj, 'user.profile.age', 30);
            _.set(obj, 'user.settings.theme', 'dark');
            
            _('#object-result').html(
                `Get: ${name}\n` +
                `After Set:\n${JSON.stringify(obj, null, 2)}`
            );
        }
        
        function demoPickOmit() {
            const user = { id: 1, name: 'John', email: 'john@example.com', password: 'secret', salt: '123' };
            
            const picked = _.pick(user, ['id', 'name', 'email']);
            const omitted = _.omit(user, ['password', 'salt']);
            
            _('#object-result').html(
                `Pick (id, name, email):\n${JSON.stringify(picked, null, 2)}\n\n` +
                `Omit (password, salt):\n${JSON.stringify(omitted, null, 2)}`
            );
        }
        
        // Array Methods
        function demoChunk() {
            const arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];
            const chunks = _.chunk(arr, 3);
            
            _('#array-result').html(JSON.stringify(chunks));
        }
        
        function demoFlatten() {
            const nested = [[1, 2], [3, [4, 5]], [6, [7, [8, 9]]]];
            
            _('#array-result').html(
                `Original: ${JSON.stringify(nested)}\n\n` +
                `Flatten (depth 1): ${JSON.stringify(_.flatten(nested, 1))}\n\n` +
                `Flatten Deep: ${JSON.stringify(_.flattenDeep(nested))}`
            );
        }
        
        function demoUniq() {
            const arr = [1, 2, 2, 3, 1, 4, 3, 5];
            const users = [
                { id: 1, name: 'John' },
                { id: 2, name: 'Jane' },
                { id: 1, name: 'John Doe' }
            ];
            
            _('#array-result').html(
                `uniq: ${JSON.stringify(_.uniq(arr))}\n\n` +
                `uniqBy (id): ${JSON.stringify(_.uniqBy(users, 'id'))}`
            );
        }
        
        function demoGroupBy() {
            const users = [
                { name: 'John', role: 'admin' },
                { name: 'Jane', role: 'user' },
                { name: 'Bob', role: 'admin' },
                { name: 'Alice', role: 'user' }
            ];
            
            const grouped = _.groupBy(users, 'role');
            _('#array-result').html(JSON.stringify(grouped, null, 2));
        }
        
        function demoSetOps() {
            const a = [1, 2, 3, 4];
            const b = [3, 4, 5, 6];
            const c = [5, 6, 7, 8];
            
            _('#array-result').html(
                `Arrays: A=${JSON.stringify(a)}, B=${JSON.stringify(b)}, C=${JSON.stringify(c)}\n\n` +
                `Intersection (A ‚à© B): ${JSON.stringify(_.intersection(a, b))}\n` +
                `Union (A ‚à™ B ‚à™ C): ${JSON.stringify(_.union(a, b, c))}\n` +
                `Difference (A - B): ${JSON.stringify(_.difference(a, b))}`
            );
        }
        
        // String Utilities
        function demoCaseConversion() {
            const text = _('#string-input').val();
            
            _('#string-result').html(
                `Original: ${text}\n\n` +
                `camelCase: ${_.camelCase(text)}\n` +
                `kebab-case: ${_.kebabCase(text)}\n` +
                `snake_case: ${_.snakeCase(text)}\n` +
                `Capitalized: ${_.capitalize(text)}\n` +
                `Title Case: ${_.capitalizeWords(text)}`
            );
        }
        
        function demoSlugify() {
            const text = _('#string-input').val();
            _('#string-result').html(`Slug: ${_.slugify(text)}`);
        }
        
        function demoTruncate() {
            const text = _('#string-input').val();
            
            _('#string-result').html(
                `Truncate(10): ${_.truncate(text, 10)}\n` +
                `Truncate(15, '‚Ä¶'): ${_.truncate(text, 15, '‚Ä¶')}`
            );
        }
        
        function demoEscape() {
            const html = '<script>alert("XSS")</script>';
            const escaped = _.escape(html);
            const unescaped = _.unescape(escaped);
            
            _('#string-result').html(
                `Original: ${html}\n\n` +
                `Escaped: ${escaped}\n\n` +
                `Unescaped: ${unescaped}`
            );
        }
        
        // Date Utilities
        function demoFormatDate() {
            const now = new Date();
            
            _('#date-result').html(
                `YYYY-MM-DD: ${_.formatDate(now, 'YYYY-MM-DD')}\n` +
                `DD/MM/YYYY: ${_.formatDate(now, 'DD/MM/YYYY')}\n` +
                `YYYY-MM-DD HH:mm:ss: ${_.formatDate(now, 'YYYY-MM-DD HH:mm:ss')}\n` +
                `HH:mm: ${_.formatDate(now, 'HH:mm')}`
            );
        }
        
        function demoFromNow() {
            const dates = [
                new Date(Date.now() - 30 * 1000), // 30 seconds ago
                new Date(Date.now() - 5 * 60 * 1000), // 5 minutes ago
                new Date(Date.now() - 2 * 60 * 60 * 1000), // 2 hours ago
                new Date(Date.now() - 3 * 24 * 60 * 60 * 1000), // 3 days ago
                new Date(Date.now() - 40 * 24 * 60 * 60 * 1000) // 40 days ago
            ];
            
            _('#date-result').html(
                dates.map((d, i) => `Date ${i + 1}: ${_.fromNow(d)}`).join('\n')
            );
        }
        
        function demoDiffDates() {
            const date1 = '2024-01-01';
            const date2 = '2024-02-13';
            
            _('#date-result').html(
                `From: ${date1}\nTo: ${date2}\n\n` +
                `Days: ${_.diffDates(date1, date2, 'days')}\n` +
                `Hours: ${_.diffDates(date1, date2, 'hours')}\n` +
                `Weeks: ${_.diffDates(date1, date2, 'weeks')}`
            );
        }
        
        function demoAddDates() {
            const now = new Date();
            
            _('#date-result').html(
                `Now: ${_.formatDate(now, 'YYYY-MM-DD HH:mm')}\n\n` +
                `+7 days: ${_.formatDate(_.addDays(now, 7), 'YYYY-MM-DD')}\n` +
                `+2 hours: ${_.formatDate(_.addHours(now, 2), 'YYYY-MM-DD HH:mm')}\n` +
                `+30 mins: ${_.formatDate(_.addMinutes(now, 30), 'YYYY-MM-DD HH:mm')}`
            );
        }
        
        // Type Checking
        function demoTypeChecking() {
            const tests = {
                'Array': _.isArray([1, 2, 3]),
                'Object': _.isObject({ a: 1 }),
                'Function': _.isFunction(() => {}),
                'String': _.isString('hello'),
                'Number': _.isNumber(123),
                'Boolean': _.isBoolean(true),
                'Null': _.isNull(null),
                'Undefined': _.isUndefined(undefined),
                'Date': _.isDate(new Date()),
                'RegExp': _.isRegExp(/test/),
                'Error': _.isError(new Error())
            };
            
            _('#type-result').html(
                Object.entries(tests).map(([name, result]) => 
                    `${name}: ${result ? '‚úÖ' : '‚ùå'}`
                ).join('\n')
            );
        }
        
        function demoIsEmpty() {
            const tests = {
                '[]': _.isEmpty([]),
                '[1, 2]': _.isEmpty([1, 2]),
                '{}': _.isEmpty({}),
                '{a: 1}': _.isEmpty({ a: 1 }),
                '""': _.isEmpty(''),
                '"hello"': _.isEmpty('hello'),
                'null': _.isEmpty(null),
                'undefined': _.isEmpty(undefined)
            };
            
            _('#type-result').html(
                Object.entries(tests).map(([name, result]) => 
                    `isEmpty(${name}): ${result ? 'true' : 'false'}`
                ).join('\n')
            );
        }
        
        // Promise/Async
        async function demoSleep() {
            _('#promise-result').html('Sleeping for 2 seconds...');
            const start = Date.now();
            await _.sleep(2000);
            const elapsed = Date.now() - start;
            _('#promise-result').html(`‚úÖ Slept for ${elapsed}ms`);
        }
        
        async function demoRetry() {
            _('#promise-result').html('Retrying failed operation...');
            let attempts = 0;
            
            try {
                await _.retry(async () => {
                    attempts++;
                    if (attempts < 3) throw new Error('Failed');
                    return 'Success!';
                }, { times: 5, delay: 500, backoff: 1.5 });
                
                _('#promise-result').html(`‚úÖ Succeeded after ${attempts} attempts`);
            } catch (error) {
                _('#promise-result').html(`‚ùå Failed after ${attempts} attempts`);
            }
        }
        
        async function demoTimeout() {
            _('#promise-result').html('Testing timeout...');
            
            try {
                await _.timeout(_.sleep(5000), 2000, 'Operation timed out');
                _('#promise-result').html('‚úÖ Completed');
            } catch (error) {
                _('#promise-result').html(`‚ùå ${error.message}`);
            }
        }
        
        async function demoAllSettled() {
            _('#promise-result').html('Running promises...');
            
            const promises = [
                Promise.resolve('Success 1'),
                Promise.reject('Error 1'),
                Promise.resolve('Success 2'),
                Promise.reject('Error 2')
            ];
            
            const results = await _.allSettled(promises);
            _('#promise-result').html(JSON.stringify(results, null, 2));
        }
        
        // Math Utilities
        function demoMath() {
            const numbers = [3, 1, 4, 1, 5, 9, 2, 6, 5, 3];
            
            _('#math-result').html(
                `Array: ${JSON.stringify(numbers)}\n\n` +
                `Sum: ${_.sum(numbers)}\n` +
                `Mean: ${_.mean(numbers).toFixed(2)}\n` +
                `Median: ${_.median(numbers)}\n` +
                `Min: ${_.min(numbers)}\n` +
                `Max: ${_.max(numbers)}`
            );
        }
        
        function demoClamp() {
            const tests = [
                [50, 0, 100],
                [-5, 0, 100],
                [150, 0, 100],
                [75, 50, 80]
            ];
            
            _('#math-result').html(
                tests.map(([val, min, max]) => 
                    `clamp(${val}, ${min}, ${max}) = ${_.clamp(val, min, max)}`
                ).join('\n')
            );
        }
        
        function demoRandom() {
            _('#math-result').html(
                `random(1, 10): ${_.random(1, 10)}\n` +
                `random(1, 10): ${_.random(1, 10)}\n` +
                `random(1, 10): ${_.random(1, 10)}\n\n` +
                `random(0, 1, true): ${_.random(0, 1, true).toFixed(4)}\n` +
                `random(0, 1, true): ${_.random(0, 1, true).toFixed(4)}\n` +
                `random(0, 1, true): ${_.random(0, 1, true).toFixed(4)}`
            );
        }
        
        // Collection Methods
        function demoRange() {
            _('#collection-result').html(
                `range(5): ${JSON.stringify(_.range(5))}\n` +
                `range(1, 5): ${JSON.stringify(_.range(1, 5))}\n` +
                `range(0, 20, 2): ${JSON.stringify(_.range(0, 20, 2))}\n` +
                `range(10, 0, -2): ${JSON.stringify(_.range(10, 0, -2))}`
            );
        }
        
        function demoShuffle() {
            const arr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            _('#collection-result').html(
                `Original: ${JSON.stringify(arr)}\n\n` +
                `Shuffled: ${JSON.stringify(_.shuffle(arr))}\n` +
                `Shuffled: ${JSON.stringify(_.shuffle(arr))}\n` +
                `Shuffled: ${JSON.stringify(_.shuffle(arr))}`
            );
        }
        
        function demoSample() {
            const arr = ['Apple', 'Banana', 'Cherry', 'Date', 'Elderberry'];
            _('#collection-result').html(
                `Array: ${JSON.stringify(arr)}\n\n` +
                `sample(): ${_.sample(arr)}\n` +
                `sample(): ${_.sample(arr)}\n` +
                `sample(): ${_.sample(arr)}\n\n` +
                `sample(3): ${JSON.stringify(_.sample(arr, 3))}`
            );
        }
        
        function demoPartition() {
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            const [evens, odds] = _.partition(numbers, n => n % 2 === 0);
            
            _('#collection-result').html(
                `Original: ${JSON.stringify(numbers)}\n\n` +
                `Evens: ${JSON.stringify(evens)}\n` +
                `Odds: ${JSON.stringify(odds)}`
            );
        }
        
        console.log('‚úÖ All utility demos ready!');
    </script>
</body>
</html>
